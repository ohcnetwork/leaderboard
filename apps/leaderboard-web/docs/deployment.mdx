---
title: Deployment
description: Deploy your leaderboard to production
---

# Deployment

Learn how to deploy your leaderboard to production.

## Static Export

The leaderboard builds as a static site, making it easy to deploy anywhere.

### Build Command

```bash
pnpm build
```

This command:
1. Runs the prebuild script (imports config, generates icons, fetches theme)
2. Builds the Next.js application
3. Exports static HTML/CSS/JS to the `out/` directory

### Output Structure

The `out/` directory contains:
- `index.html` - Home page
- `leaderboard/` - Leaderboard pages
- `people/` - People page
- `docs/` - Documentation
- `[username]/` - Individual contributor pages
- `_next/` - Next.js assets (JS, CSS, images)

## Deployment Options

### Netlify

**Drag and Drop:**
1. Build your site: `pnpm build`
2. Go to [Netlify Drop](https://app.netlify.com/drop)
3. Drag the `out/` folder

**Git Integration:**
1. Connect your repository
2. Set build command: `pnpm build`
3. Set publish directory: `out`
4. Deploy

### Vercel

**CLI Deployment:**
```bash
pnpm build
vercel --prod
```

**Git Integration:**
1. Import your repository on [Vercel](https://vercel.com)
2. Vercel auto-detects Next.js settings
3. Deploy automatically on push

### GitHub Pages

**Using GitHub Actions:**

Create `.github/workflows/deploy.yml`:

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      
      - run: pnpm install
      - run: pnpm build
      
      - uses: actions/upload-pages-artifact@v2
        with:
          path: ./out

  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - uses: actions/deploy-pages@v2
        id: deployment
```

Enable GitHub Pages in repository settings.

### Cloudflare Pages

**Using Wrangler:**
```bash
pnpm build
wrangler pages publish out
```

**Git Integration:**
1. Connect repository on [Cloudflare Pages](https://pages.cloudflare.com)
2. Set build command: `pnpm build`
3. Set output directory: `out`
4. Deploy

### AWS S3 + CloudFront

**Upload to S3:**
```bash
pnpm build
aws s3 sync out/ s3://your-bucket-name --delete
```

**Invalidate CloudFront:**
```bash
aws cloudfront create-invalidation \
  --distribution-id YOUR_DIST_ID \
  --paths "/*"
```

### Docker

Create a `Dockerfile` for serving with nginx:

```dockerfile
FROM nginx:alpine

COPY out /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

Create `nginx.conf`:

```nginx
server {
    listen 80;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ $uri.html =404;
    }

    # Cache static assets
    location /_next/static {
        add_header Cache-Control "public, max-age=31536000, immutable";
    }
}
```

Build and run:

```bash
docker build -t leaderboard .
docker run -p 8080:80 leaderboard
```

## Environment Variables

### Build-time Variables

Required for building:

```bash
# Database path for build
PGLITE_DB_PATH=../pglite-data

# Data source path (if importing during build)
LEADERBOARD_DATA_PATH=../leaderboard-data
```

### Deployment Variables

Set these in your deployment platform:

- `NODE_ENV=production` - Production mode
- `NEXT_PUBLIC_SITE_URL` - Your site URL (for canonical URLs)

## Custom Domain

### Netlify

1. Go to Domain settings
2. Add custom domain
3. Configure DNS with your provider

### Vercel

1. Go to Project Settings â†’ Domains
2. Add your domain
3. Configure DNS records

### GitHub Pages

1. Add `CNAME` file to `public/` directory:
   ```
   leaderboard.your-domain.com
   ```
2. Configure DNS with CNAME record pointing to `username.github.io`

### Cloudflare Pages

1. Go to Custom Domains
2. Add your domain
3. DNS is automatically configured if using Cloudflare

## Redirects

The leaderboard includes a `_redirects` file for handling old URLs:

```
/contributors/:username  /:username  301
```

This is automatically included in the build output.

## Performance Optimization

### Image Optimization

Images are set to `unoptimized: true` for static export. For better performance:

1. Optimize images before adding them
2. Use WebP format
3. Provide multiple sizes
4. Use a CDN

### Caching

Set cache headers for static assets:

```
/_next/static/*
  Cache-Control: public, max-age=31536000, immutable

/*.css
  Cache-Control: public, max-age=31536000, immutable

/*.js
  Cache-Control: public, max-age=31536000, immutable
```

### CDN

Use a CDN for better global performance:
- Cloudflare (free tier available)
- AWS CloudFront
- Fastly
- Vercel Edge Network (included)

## Continuous Deployment

### GitHub Actions Workflow

Generate a complete workflow:

```bash
pnpm generate:workflow
```

This creates `.github/workflows/update-data.yml` that:
1. Runs scrapers on schedule
2. Imports new data
3. Builds the site
4. Deploys to your platform

### Manual Workflow

Create a custom workflow for your needs:

```yaml
name: Update and Deploy

on:
  schedule:
    - cron: '0 */12 * * *'  # Every 12 hours
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      
      - run: pnpm install
      
      # Run your scrapers here
      - run: pnpm scrape:github
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - run: pnpm scrape:slack
        env:
          SLACK_TOKEN: ${{ secrets.SLACK_TOKEN }}
      
      # Import and build
      - run: pnpm db:import
      - run: pnpm build
      
      # Deploy (example for Netlify)
      - uses: netlify/actions/cli@master
        with:
          args: deploy --prod --dir=out
        env:
          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
```

## Monitoring

### Health Checks

Add a health check endpoint by creating `public/health.json`:

```json
{
  "status": "ok",
  "version": "0.2.0"
}
```

### Analytics

Add analytics to track usage:

**Google Analytics:**
Add to `app/layout.tsx`:

```tsx
import Script from 'next/script'

<Script
  src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"
  strategy="afterInteractive"
/>
```

**Plausible Analytics:**
Add to `app/layout.tsx`:

```tsx
<Script
  defer
  data-domain="your-domain.com"
  src="https://plausible.io/js/script.js"
/>
```

## Troubleshooting

### Build Fails

Common issues:
- Missing environment variables
- Database not initialized
- Invalid configuration
- Out of memory (increase Node.js heap size)

### 404 Errors

Ensure your hosting platform is configured for SPA routing:
- Netlify: `_redirects` file (included)
- Vercel: Automatic
- GitHub Pages: May need custom 404.html
- S3: Configure error document

### Slow Builds

Optimize build time:
- Cache dependencies
- Use incremental builds
- Reduce data size
- Parallelize scraper runs

## Next Steps

- [Set up scrapers](/docs/scrapers)
- [Configure automated updates](/docs/scrapers#automation)
- [Monitor your deployment](/docs/troubleshooting)

