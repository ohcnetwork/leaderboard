# Documentation

Welcome to the **ohc.network Leaderboard** documentation. This platform tracks and celebrates contributions across the Open Healthcare Network ecosystem.

## Overview

The OHC Leaderboard is a comprehensive contribution tracking system that monitors activities across GitHub, Slack, and other platforms. It provides insights into contributor engagement, recognizes top performers, and helps maintain transparency in open-source collaboration.

### Key Features

- **Real-time Activity Tracking** - Monitor contributions as they happen
- **Multi-platform Integration** - Track activities from GitHub, Slack, and more
- **Role-based Recognition** - Different contributor roles with custom badges
- **Interactive Visualizations** - Beautiful charts and graphs showing contribution trends
- **Contributor Profiles** - Detailed pages for each contributor with activity breakdowns
- **Leaderboard Rankings** - Weekly, monthly, and yearly leaderboards

## Getting Started

### Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js** 20 or higher
- **pnpm** (recommended) or npm
- **Git** for version control

### Installation

Clone the repository and install dependencies:

```bash
git clone https://github.com/ohcnetwork/leaderboard.git
cd leaderboard
pnpm install
```

### Configuration

The leaderboard is configured using a `config.yaml` file. Copy the example configuration:

```bash
cp config.example.yaml config.yaml
```

Edit `config.yaml` to customize your leaderboard:

```yaml
org:
  name: Your Organization
  description: Your organization description
  url: https://your-org.com
  logo_url: https://your-org.com/logo.svg

meta:
  title: Leaderboard - Your Organization
  description: Track contributions across your organization
  site_url: https://leaderboard.your-org.com

leaderboard:
  data_source: https://github.com/your-org/leaderboard-data
  roles:
    core:
      name: Core Team
      description: Core team members
```

### Development

Start the development server:

```bash
pnpm dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser to see the leaderboard.

### Building for Production

Build the static site:

```bash
pnpm build
```

The output will be in the `out/` directory, ready to be deployed to any static hosting service.

## Configuration Reference

### Organization Settings

Configure your organization's basic information:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `org.name` | string | Yes | Organization name |
| `org.description` | string | Yes | Brief description |
| `org.url` | string | Yes | Organization website |
| `org.logo_url` | string | Yes | Logo image URL |
| `org.start_date` | date | No | Organization founding date |

### Metadata Settings

SEO and site metadata configuration:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `meta.title` | string | Yes | Site title |
| `meta.description` | string | Yes | Site description |
| `meta.image_url` | string | Yes | Social media preview image |
| `meta.site_url` | string | Yes | Full site URL |
| `meta.favicon_url` | string | Yes | Favicon URL |

### Leaderboard Settings

Configure leaderboard behavior and data sources:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `leaderboard.data_source` | string | Yes | GitHub repository with leaderboard data |
| `leaderboard.theme` | string | No | URL to custom theme CSS |
| `leaderboard.roles` | object | Yes | Role definitions (minimum 1) |

### Roles Configuration

Define contributor roles with custom properties:

```yaml
leaderboard:
  roles:
    core:
      name: Core Team
      description: Core team members
    contributor:
      name: Contributor
      description: Open source contributors
    bot:
      name: Bot
      description: Bot accounts
      hidden: true  # Hide from leaderboard
```

## Data Management

### Database Scripts

The leaderboard uses PGlite for local data storage. Several scripts are available for database management:

- `pnpm db:prepare` - Initialize the database schema
- `pnpm db:import` - Import data from the data source
- `pnpm db:export` - Export current database state
- `pnpm db:exec` - Execute SQL commands via stdin

### Data Source Structure

The leaderboard expects data in a specific format from your data source repository. The data should include:

- **Contributors** - User profiles with roles and metadata
- **Activities** - Timestamped contribution events
- **Aggregates** - Pre-calculated statistics

## Customization

### Theming

The leaderboard supports custom themes through CSS variables. You can:

1. **Use the built-in theme** - Light and dark modes included
2. **Customize CSS variables** - Override colors in `globals.css`
3. **Provide a remote theme** - Set `leaderboard.theme` in config

#### CSS Variables

Key theme variables you can customize:

```css
:root {
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  /* ... more variables */
}
```

### Custom Activity Types

Define custom activity types in your data source to track organization-specific contributions.

## Deployment

### Static Export

The leaderboard builds as a static site, making it easy to deploy anywhere:

```bash
pnpm build
```

### Deployment Options

- **Netlify** - Drag and drop the `out/` folder
- **Vercel** - Connect your GitHub repository
- **GitHub Pages** - Push the `out/` folder to `gh-pages` branch
- **Cloudflare Pages** - Connect your repository
- **Any static host** - Upload the `out/` folder

### GitHub Actions

Generate a workflow for automated data updates:

```bash
pnpm generate:workflow
```

This creates `.github/workflows/update-data.yml` that runs scrapers on a schedule.

## Scrapers

Scrapers collect contribution data from various platforms. The leaderboard supports:

### GitHub Scraper

Tracks GitHub activities:
- Pull requests (opened, merged, reviewed)
- Issues (opened, closed, assigned)
- Comments and discussions
- Code reviews

### Slack Scraper

Monitors Slack engagement:
- Messages sent
- Threads participated in
- Reactions given
- Channel activity

### Custom Scrapers

You can create custom scrapers for other platforms. Scrapers should:

1. Fetch data from the source platform
2. Transform it to the leaderboard schema
3. Output JSON in the expected format

## Testing

Run the test suite:

```bash
pnpm test
```

Run tests with coverage:

```bash
pnpm test:coverage
```

Run tests in watch mode during development:

```bash
pnpm test:watch
```

## Contributing

We welcome contributions! Here's how you can help:

1. **Fork the repository**
2. **Create a feature branch** - `git checkout -b feature/amazing-feature`
3. **Make your changes** - Follow the code style
4. **Write tests** - Ensure your changes are tested
5. **Commit your changes** - `git commit -m 'Add amazing feature'`
6. **Push to your fork** - `git push origin feature/amazing-feature`
7. **Open a Pull Request** - Describe your changes

### Code Style

- Use TypeScript for type safety
- Follow the existing code structure
- Write meaningful commit messages
- Add tests for new features

## Troubleshooting

### Common Issues

**Build fails with PGlite errors**

The project limits CPU usage to avoid PGlite concurrency issues. This is configured in `next.config.ts`:

```typescript
experimental: {
  cpus: 1,
}
```

**Images not loading in production**

Ensure `images.unoptimized: true` is set in `next.config.ts` for static exports.

**Data not updating**

Check that:
1. Your data source repository is accessible
2. The GitHub Actions workflow is running
3. The data format matches the expected schema

## API Reference

### Configuration Schema

The complete configuration schema is available in `config.schema.json`. Use it for:

- IDE autocomplete and validation
- Programmatic config generation
- Documentation of all options

### Database Schema

The database schema is defined in `lib/db.ts`. Key tables:

- `contributors` - User profiles and metadata
- `activities` - Individual contribution events
- `aggregates` - Pre-calculated statistics
- `roles` - Role definitions and assignments

## Support

Need help? Here's how to get support:

- **GitHub Issues** - Report bugs or request features
- **Slack** - Join our community at [slack.ohc.network](https://slack.ohc.network)
- **Email** - Contact us at support@ohc.network
- **Documentation** - Check this guide first

## License

This project is licensed under the MIT License. See the [LICENSE](https://github.com/ohcnetwork/leaderboard/blob/main/LICENSE) file for details.

## Acknowledgments

Built with ❤️ by the Open Healthcare Network community.

Special thanks to all contributors who make this project possible!

---

**Version**: 0.2.0  
**Last Updated**: November 2025  
**Maintained by**: [Open Healthcare Network](https://ohc.network)
